version: '3.5'

services:
  dokuwiki-nginx:
    image: necromant/dokuwiki-nginx
    hostname: dokuwiki-nginx
    depends_on:
      - php-fpm
    networks:
      - public
      - private

    restart: unless-stopped
    deploy:
      mode: replicated
      replicas: 2

  php-fpm:
    image: necromant/dokuwiki-php-fpm
    hostname: php-fpm
    networks:
      - private

    restart: unless-stopped
    deploy:
      mode: replicated
      replicas: 1


networks:
  public:
    external: true
  private:
